àS
dC:\Users\d.daniel.de.sousa\source\repos\RedatorSaude\RedatorSaude\Controllers\DocumentsController.cs
	namespace 	
RedatorSaude
 
. 
Controllers "
{ 
[ 
	Authorize 
] 
public 

class 
DocumentsController $
:% &

Controller' 1
{ 
private 
readonly  
ApplicationDbContext -
_context. 6
;6 7
public 
DocumentsController "
(" # 
ApplicationDbContext# 7
context8 ?
)? @
{ 	
_context 
= 
context 
; 
} 	
public 
async 
Task 
< 
IActionResult '
>' (
Index) .
(. /
)/ 0
{ 	
return 
View 
( 
await 
_context &
.& '
Document' /
./ 0
ToListAsync0 ;
(; <
)< =
)= >
;> ?
} 	
public 
async 
Task 
< 
IActionResult '
>' (
Details) 0
(0 1
int1 4
?4 5
id6 8
)8 9
{   	
if!! 
(!! 
id!! 
==!! 
null!! 
)!! 
{"" 
return## 
NotFound## 
(##  
)##  !
;##! "
}$$ 
var&& 
document&& 
=&& 
await&&  
_context&&! )
.&&) *
Document&&* 2
.'' 
FirstOrDefaultAsync'' $
(''$ %
m''% &
=>''' )
m''* +
.''+ ,
id'', .
==''/ 1
id''2 4
)''4 5
;''5 6
if(( 
((( 
document(( 
==(( 
null((  
)((  !
{)) 
return** 
NotFound** 
(**  
)**  !
;**! "
}++ 
return-- 
View-- 
(-- 
document--  
)--  !
;--! "
}.. 	
public11 
IActionResult11 
Create11 #
(11# $
)11$ %
{22 	
return33 
View33 
(33 
)33 
;33 
}44 	
[99 	
HttpPost99	 
]99 
[:: 	$
ValidateAntiForgeryToken::	 !
]::! "
public;; 
async;; 
Task;; 
<;; 
IActionResult;; '
>;;' (
Create;;) /
(;;/ 0
[;;0 1
Bind;;1 5
(;;5 6
$str;;6 t
);;t u
];;u v
Document;;w 
documentoSimples
;;Ä ê
)
;;ê ë
{<< 	
if== 
(== 

ModelState== 
.== 
IsValid== "
)==" #
{>> 
try?? 
{@@ 
StreamAA 
streamAA !
=AA" #
DocumentServiceAA$ 3
.AA3 4
CreateSimpleDocAA4 C
(AAC D
documentoSimplesAAD T
)AAT U
;AAU V
ifBB 
(BB 
streamBB 
!=BB !
nullBB" &
)BB& '
{CC 
_contextDD  
.DD  !
AddDD! $
(DD$ %
documentoSimplesDD% 5
)DD5 6
;DD6 7
awaitFF 
_contextFF &
.FF& '
SaveChangesAsyncFF' 7
(FF7 8
)FF8 9
;FF9 :
varHH 

typeStringHH &
=HH' ( 
SimpleDocumentHelperHH) =
.HH= >
GetTypeStringHH> K
(HHK L
documentoSimplesHHL \
.HH\ ]
NomePecaHH] e
)HHe f
;HHf g
returnII 
FileII #
(II# $
streamII$ *
,II* +
$strII, u
,IIu v
$str	IIw É
+
IIÑ Ö

typeString
IIÜ ê
+
IIë í
$str
IIì ö
)
IIö õ
;
IIõ ú
}JJ 
}KK 
catchLL 
(LL 
	ExceptionLL  
eLL! "
)LL" #
{MM 
returnPP 
RedirectToActionPP +
(PP+ ,
nameofPP, 2
(PP2 3
IndexPP3 8
)PP8 9
)PP9 :
;PP: ;
}QQ 
}RR 
returnSS 
ViewSS 
(SS 
documentoSimplesSS (
)SS( )
;SS) *
}TT 	
publicWW 
asyncWW 
TaskWW 
<WW 
IActionResultWW '
>WW' (
EditWW) -
(WW- .
intWW. 1
?WW1 2
idWW3 5
)WW5 6
{XX 	
ifYY 
(YY 
idYY 
==YY 
nullYY 
)YY 
{ZZ 
return[[ 
NotFound[[ 
([[  
)[[  !
;[[! "
}\\ 
var^^ 
document^^ 
=^^ 
await^^  
_context^^! )
.^^) *
Document^^* 2
.^^2 3
	FindAsync^^3 <
(^^< =
id^^= ?
)^^? @
;^^@ A
if__ 
(__ 
document__ 
==__ 
null__  
)__  !
{`` 
returnaa 
NotFoundaa 
(aa  
)aa  !
;aa! "
}bb 
returncc 
Viewcc 
(cc 
documentcc  
)cc  !
;cc! "
}dd 	
[ii 	
HttpPostii	 
]ii 
[jj 	$
ValidateAntiForgeryTokenjj	 !
]jj! "
publickk 
asynckk 
Taskkk 
<kk 
IActionResultkk '
>kk' (
Editkk) -
(kk- .
intkk. 1
idkk2 4
,kk4 5
[kk6 7
Bindkk7 ;
(kk; <
$str	kk< Ü
)
kkÜ á
]
kká à
Document
kkâ ë
document
kkí ö
)
kkö õ
{ll 	
ifmm 
(mm 
idmm 
!=mm 
documentmm 
.mm 
idmm !
)mm! "
{nn 
returnoo 
NotFoundoo 
(oo  
)oo  !
;oo! "
}pp 
ifrr 
(rr 

ModelStaterr 
.rr 
IsValidrr "
)rr" #
{ss 
trytt 
{uu 
_contextvv 
.vv 
Updatevv #
(vv# $
documentvv$ ,
)vv, -
;vv- .
awaitww 
_contextww "
.ww" #
SaveChangesAsyncww# 3
(ww3 4
)ww4 5
;ww5 6
}xx 
catchyy 
(yy (
DbUpdateConcurrencyExceptionyy 3
)yy3 4
{zz 
if{{ 
({{ 
!{{ 
DocumentExists{{ '
({{' (
document{{( 0
.{{0 1
id{{1 3
){{3 4
){{4 5
{|| 
return}} 
NotFound}} '
(}}' (
)}}( )
;}}) *
}~~ 
else 
{
ÄÄ 
throw
ÅÅ 
;
ÅÅ 
}
ÇÇ 
}
ÉÉ 
return
ÑÑ 
RedirectToAction
ÑÑ '
(
ÑÑ' (
nameof
ÑÑ( .
(
ÑÑ. /
Index
ÑÑ/ 4
)
ÑÑ4 5
)
ÑÑ5 6
;
ÑÑ6 7
}
ÖÖ 
return
ÜÜ 
View
ÜÜ 
(
ÜÜ 
document
ÜÜ  
)
ÜÜ  !
;
ÜÜ! "
}
áá 	
public
ää 
async
ää 
Task
ää 
<
ää 
IActionResult
ää '
>
ää' (
Delete
ää) /
(
ää/ 0
int
ää0 3
?
ää3 4
id
ää5 7
)
ää7 8
{
ãã 	
if
åå 
(
åå 
id
åå 
==
åå 
null
åå 
)
åå 
{
çç 
return
éé 
NotFound
éé 
(
éé  
)
éé  !
;
éé! "
}
èè 
var
ëë 
document
ëë 
=
ëë 
await
ëë  
_context
ëë! )
.
ëë) *
Document
ëë* 2
.
íí !
FirstOrDefaultAsync
íí $
(
íí$ %
m
íí% &
=>
íí' )
m
íí* +
.
íí+ ,
id
íí, .
==
íí/ 1
id
íí2 4
)
íí4 5
;
íí5 6
if
ìì 
(
ìì 
document
ìì 
==
ìì 
null
ìì  
)
ìì  !
{
îî 
return
ïï 
NotFound
ïï 
(
ïï  
)
ïï  !
;
ïï! "
}
ññ 
return
òò 
View
òò 
(
òò 
document
òò  
)
òò  !
;
òò! "
}
ôô 	
[
úú 	
HttpPost
úú	 
,
úú 

ActionName
úú 
(
úú 
$str
úú &
)
úú& '
]
úú' (
[
ùù 	&
ValidateAntiForgeryToken
ùù	 !
]
ùù! "
public
ûû 
async
ûû 
Task
ûû 
<
ûû 
IActionResult
ûû '
>
ûû' (
DeleteConfirmed
ûû) 8
(
ûû8 9
int
ûû9 <
id
ûû= ?
)
ûû? @
{
üü 	
var
†† 
document
†† 
=
†† 
await
††  
_context
††! )
.
††) *
Document
††* 2
.
††2 3
	FindAsync
††3 <
(
††< =
id
††= ?
)
††? @
;
††@ A
_context
°° 
.
°° 
Document
°° 
.
°° 
Remove
°° $
(
°°$ %
document
°°% -
)
°°- .
;
°°. /
await
¢¢ 
_context
¢¢ 
.
¢¢ 
SaveChangesAsync
¢¢ +
(
¢¢+ ,
)
¢¢, -
;
¢¢- .
return
££ 
RedirectToAction
££ #
(
££# $
nameof
££$ *
(
££* +
Index
££+ 0
)
££0 1
)
££1 2
;
££2 3
}
§§ 	
private
¶¶ 
bool
¶¶ 
DocumentExists
¶¶ #
(
¶¶# $
int
¶¶$ '
id
¶¶( *
)
¶¶* +
{
ßß 	
return
®® 
_context
®® 
.
®® 
Document
®® $
.
®®$ %
Any
®®% (
(
®®( )
e
®®) *
=>
®®+ -
e
®®. /
.
®®/ 0
id
®®0 2
==
®®3 5
id
®®6 8
)
®®8 9
;
®®9 :
}
©© 	
}
™™ 
}´´ ¸
_C:\Users\d.daniel.de.sousa\source\repos\RedatorSaude\RedatorSaude\Controllers\HomeController.cs
	namespace

 	
RedatorSaude


 
.

 
Controllers

 "
{ 
public 

class 
HomeController 
:  !

Controller" ,
{ 
private 
readonly 
ILogger  
<  !
HomeController! /
>/ 0
_logger1 8
;8 9
public 
HomeController 
( 
ILogger %
<% &
HomeController& 4
>4 5
logger6 <
)< =
{ 	
_logger 
= 
logger 
; 
} 	
public 
IActionResult 
Index "
(" #
)# $
{ 	
return 
View 
( 
) 
; 
} 	
public 
IActionResult 
Privacy $
($ %
)% &
{ 	
return 
View 
( 
) 
; 
} 	
[ 	
ResponseCache	 
( 
Duration 
=  !
$num" #
,# $
Location% -
=. /!
ResponseCacheLocation0 E
.E F
NoneF J
,J K
NoStoreL S
=T U
trueV Z
)Z [
][ \
public   
IActionResult   
Error   "
(  " #
)  # $
{!! 	
return"" 
View"" 
("" 
new"" 
ErrorViewModel"" *
{""+ ,
	RequestId""- 6
=""7 8
Activity""9 A
.""A B
Current""B I
?""I J
.""J K
Id""K M
??""N P
HttpContext""Q \
.""\ ]
TraceIdentifier""] l
}""m n
)""n o
;""o p
}## 	
}$$ 
}%% ≥
^C:\Users\d.daniel.de.sousa\source\repos\RedatorSaude\RedatorSaude\Data\ApplicationDbContext.cs
	namespace 	
RedatorSaude
 
. 
Data 
{		 
public

 

class

  
ApplicationDbContext

 %
:

& '
IdentityDbContext

( 9
{ 
public  
ApplicationDbContext #
(# $
DbContextOptions$ 4
<4 5 
ApplicationDbContext5 I
>I J
optionsK R
)R S
: 
base 
( 
options 
) 
{ 	
} 	
public 
DbSet 
< 
RedatorSaude !
.! "
Models" (
.( )
Document) 1
>1 2
Document3 ;
{< =
get> A
;A B
setC F
;F G
}H I
} 
} í∂
xC:\Users\d.daniel.de.sousa\source\repos\RedatorSaude\RedatorSaude\Data\Migrations\00000000000000_CreateIdentitySchema.cs
	namespace 	
RedatorSaude
 
. 
Data 
. 

Migrations &
{ 
public 

partial 
class  
CreateIdentitySchema -
:. /
	Migration0 9
{ 
	protected		 
override		 
void		 
Up		  "
(		" #
MigrationBuilder		# 3
migrationBuilder		4 D
)		D E
{

 	
migrationBuilder 
. 
CreateTable (
(( )
name 
: 
$str #
,# $
columns 
: 
table 
=> !
new" %
{ 
Id 
= 
table 
. 
Column %
<% &
string& ,
>, -
(- .
nullable. 6
:6 7
false8 =
)= >
,> ?
Name 
= 
table  
.  !
Column! '
<' (
string( .
>. /
(/ 0
	maxLength0 9
:9 :
$num; >
,> ?
nullable@ H
:H I
trueJ N
)N O
,O P
NormalizedName "
=# $
table% *
.* +
Column+ 1
<1 2
string2 8
>8 9
(9 :
	maxLength: C
:C D
$numE H
,H I
nullableJ R
:R S
trueT X
)X Y
,Y Z
ConcurrencyStamp $
=% &
table' ,
., -
Column- 3
<3 4
string4 :
>: ;
(; <
nullable< D
:D E
trueF J
)J K
} 
, 
constraints 
: 
table "
=># %
{ 
table 
. 

PrimaryKey $
($ %
$str% 5
,5 6
x7 8
=>9 ;
x< =
.= >
Id> @
)@ A
;A B
} 
) 
; 
migrationBuilder 
. 
CreateTable (
(( )
name 
: 
$str #
,# $
columns 
: 
table 
=> !
new" %
{ 
Id 
= 
table 
. 
Column %
<% &
string& ,
>, -
(- .
nullable. 6
:6 7
false8 =
)= >
,> ?
UserName 
= 
table $
.$ %
Column% +
<+ ,
string, 2
>2 3
(3 4
	maxLength4 =
:= >
$num? B
,B C
nullableD L
:L M
trueN R
)R S
,S T
NormalizedUserName &
=' (
table) .
.. /
Column/ 5
<5 6
string6 <
>< =
(= >
	maxLength> G
:G H
$numI L
,L M
nullableN V
:V W
trueX \
)\ ]
,] ^
Email   
=   
table   !
.  ! "
Column  " (
<  ( )
string  ) /
>  / 0
(  0 1
	maxLength  1 :
:  : ;
$num  < ?
,  ? @
nullable  A I
:  I J
true  K O
)  O P
,  P Q
NormalizedEmail!! #
=!!$ %
table!!& +
.!!+ ,
Column!!, 2
<!!2 3
string!!3 9
>!!9 :
(!!: ;
	maxLength!!; D
:!!D E
$num!!F I
,!!I J
nullable!!K S
:!!S T
true!!U Y
)!!Y Z
,!!Z [
EmailConfirmed"" "
=""# $
table""% *
.""* +
Column""+ 1
<""1 2
bool""2 6
>""6 7
(""7 8
nullable""8 @
:""@ A
false""B G
)""G H
,""H I
PasswordHash##  
=##! "
table### (
.##( )
Column##) /
<##/ 0
string##0 6
>##6 7
(##7 8
nullable##8 @
:##@ A
true##B F
)##F G
,##G H
SecurityStamp$$ !
=$$" #
table$$$ )
.$$) *
Column$$* 0
<$$0 1
string$$1 7
>$$7 8
($$8 9
nullable$$9 A
:$$A B
true$$C G
)$$G H
,$$H I
ConcurrencyStamp%% $
=%%% &
table%%' ,
.%%, -
Column%%- 3
<%%3 4
string%%4 :
>%%: ;
(%%; <
nullable%%< D
:%%D E
true%%F J
)%%J K
,%%K L
PhoneNumber&& 
=&&  !
table&&" '
.&&' (
Column&&( .
<&&. /
string&&/ 5
>&&5 6
(&&6 7
nullable&&7 ?
:&&? @
true&&A E
)&&E F
,&&F G 
PhoneNumberConfirmed'' (
='') *
table''+ 0
.''0 1
Column''1 7
<''7 8
bool''8 <
>''< =
(''= >
nullable''> F
:''F G
false''H M
)''M N
,''N O
TwoFactorEnabled(( $
=((% &
table((' ,
.((, -
Column((- 3
<((3 4
bool((4 8
>((8 9
(((9 :
nullable((: B
:((B C
false((D I
)((I J
,((J K

LockoutEnd)) 
=))  
table))! &
.))& '
Column))' -
<))- .
DateTimeOffset)). <
>))< =
())= >
nullable))> F
:))F G
true))H L
)))L M
,))M N
LockoutEnabled** "
=**# $
table**% *
.*** +
Column**+ 1
<**1 2
bool**2 6
>**6 7
(**7 8
nullable**8 @
:**@ A
false**B G
)**G H
,**H I
AccessFailedCount++ %
=++& '
table++( -
.++- .
Column++. 4
<++4 5
int++5 8
>++8 9
(++9 :
nullable++: B
:++B C
false++D I
)++I J
},, 
,,, 
constraints-- 
:-- 
table-- "
=>--# %
{.. 
table// 
.// 

PrimaryKey// $
(//$ %
$str//% 5
,//5 6
x//7 8
=>//9 ;
x//< =
.//= >
Id//> @
)//@ A
;//A B
}00 
)00 
;00 
migrationBuilder22 
.22 
CreateTable22 (
(22( )
name33 
:33 
$str33 (
,33( )
columns44 
:44 
table44 
=>44 !
new44" %
{55 
Id66 
=66 
table66 
.66 
Column66 %
<66% &
int66& )
>66) *
(66* +
nullable66+ 3
:663 4
false665 :
)66: ;
.77 

Annotation77 #
(77# $
$str77$ G
,77G H,
 SqlServerValueGenerationStrategy77I i
.77i j
IdentityColumn77j x
)77x y
,77y z
RoleId88 
=88 
table88 "
.88" #
Column88# )
<88) *
string88* 0
>880 1
(881 2
nullable882 :
:88: ;
false88< A
)88A B
,88B C
	ClaimType99 
=99 
table99  %
.99% &
Column99& ,
<99, -
string99- 3
>993 4
(994 5
nullable995 =
:99= >
true99? C
)99C D
,99D E

ClaimValue:: 
=::  
table::! &
.::& '
Column::' -
<::- .
string::. 4
>::4 5
(::5 6
nullable::6 >
:::> ?
true::@ D
)::D E
};; 
,;; 
constraints<< 
:<< 
table<< "
=><<# %
{== 
table>> 
.>> 

PrimaryKey>> $
(>>$ %
$str>>% :
,>>: ;
x>>< =
=>>>> @
x>>A B
.>>B C
Id>>C E
)>>E F
;>>F G
table?? 
.?? 

ForeignKey?? $
(??$ %
name@@ 
:@@ 
$str@@ F
,@@F G
columnAA 
:AA 
xAA  !
=>AA" $
xAA% &
.AA& '
RoleIdAA' -
,AA- .
principalTableBB &
:BB& '
$strBB( 5
,BB5 6
principalColumnCC '
:CC' (
$strCC) -
,CC- .
onDeleteDD  
:DD  !
ReferentialActionDD" 3
.DD3 4
CascadeDD4 ;
)DD; <
;DD< =
}EE 
)EE 
;EE 
migrationBuilderGG 
.GG 
CreateTableGG (
(GG( )
nameHH 
:HH 
$strHH (
,HH( )
columnsII 
:II 
tableII 
=>II !
newII" %
{JJ 
IdKK 
=KK 
tableKK 
.KK 
ColumnKK %
<KK% &
intKK& )
>KK) *
(KK* +
nullableKK+ 3
:KK3 4
falseKK5 :
)KK: ;
.LL 

AnnotationLL #
(LL# $
$strLL$ G
,LLG H,
 SqlServerValueGenerationStrategyLLI i
.LLi j
IdentityColumnLLj x
)LLx y
,LLy z
UserIdMM 
=MM 
tableMM "
.MM" #
ColumnMM# )
<MM) *
stringMM* 0
>MM0 1
(MM1 2
nullableMM2 :
:MM: ;
falseMM< A
)MMA B
,MMB C
	ClaimTypeNN 
=NN 
tableNN  %
.NN% &
ColumnNN& ,
<NN, -
stringNN- 3
>NN3 4
(NN4 5
nullableNN5 =
:NN= >
trueNN? C
)NNC D
,NND E

ClaimValueOO 
=OO  
tableOO! &
.OO& '
ColumnOO' -
<OO- .
stringOO. 4
>OO4 5
(OO5 6
nullableOO6 >
:OO> ?
trueOO@ D
)OOD E
}PP 
,PP 
constraintsQQ 
:QQ 
tableQQ "
=>QQ# %
{RR 
tableSS 
.SS 

PrimaryKeySS $
(SS$ %
$strSS% :
,SS: ;
xSS< =
=>SS> @
xSSA B
.SSB C
IdSSC E
)SSE F
;SSF G
tableTT 
.TT 

ForeignKeyTT $
(TT$ %
nameUU 
:UU 
$strUU F
,UUF G
columnVV 
:VV 
xVV  !
=>VV" $
xVV% &
.VV& '
UserIdVV' -
,VV- .
principalTableWW &
:WW& '
$strWW( 5
,WW5 6
principalColumnXX '
:XX' (
$strXX) -
,XX- .
onDeleteYY  
:YY  !
ReferentialActionYY" 3
.YY3 4
CascadeYY4 ;
)YY; <
;YY< =
}ZZ 
)ZZ 
;ZZ 
migrationBuilder\\ 
.\\ 
CreateTable\\ (
(\\( )
name]] 
:]] 
$str]] (
,]]( )
columns^^ 
:^^ 
table^^ 
=>^^ !
new^^" %
{__ 
LoginProvider`` !
=``" #
table``$ )
.``) *
Column``* 0
<``0 1
string``1 7
>``7 8
(``8 9
	maxLength``9 B
:``B C
$num``D G
,``G H
nullable``I Q
:``Q R
false``S X
)``X Y
,``Y Z
ProviderKeyaa 
=aa  !
tableaa" '
.aa' (
Columnaa( .
<aa. /
stringaa/ 5
>aa5 6
(aa6 7
	maxLengthaa7 @
:aa@ A
$numaaB E
,aaE F
nullableaaG O
:aaO P
falseaaQ V
)aaV W
,aaW X
ProviderDisplayNamebb '
=bb( )
tablebb* /
.bb/ 0
Columnbb0 6
<bb6 7
stringbb7 =
>bb= >
(bb> ?
nullablebb? G
:bbG H
truebbI M
)bbM N
,bbN O
UserIdcc 
=cc 
tablecc "
.cc" #
Columncc# )
<cc) *
stringcc* 0
>cc0 1
(cc1 2
nullablecc2 :
:cc: ;
falsecc< A
)ccA B
}dd 
,dd 
constraintsee 
:ee 
tableee "
=>ee# %
{ff 
tablegg 
.gg 

PrimaryKeygg $
(gg$ %
$strgg% :
,gg: ;
xgg< =
=>gg> @
newggA D
{ggE F
xggG H
.ggH I
LoginProviderggI V
,ggV W
xggX Y
.ggY Z
ProviderKeyggZ e
}ggf g
)ggg h
;ggh i
tablehh 
.hh 

ForeignKeyhh $
(hh$ %
nameii 
:ii 
$strii F
,iiF G
columnjj 
:jj 
xjj  !
=>jj" $
xjj% &
.jj& '
UserIdjj' -
,jj- .
principalTablekk &
:kk& '
$strkk( 5
,kk5 6
principalColumnll '
:ll' (
$strll) -
,ll- .
onDeletemm  
:mm  !
ReferentialActionmm" 3
.mm3 4
Cascademm4 ;
)mm; <
;mm< =
}nn 
)nn 
;nn 
migrationBuilderpp 
.pp 
CreateTablepp (
(pp( )
nameqq 
:qq 
$strqq '
,qq' (
columnsrr 
:rr 
tablerr 
=>rr !
newrr" %
{ss 
UserIdtt 
=tt 
tablett "
.tt" #
Columntt# )
<tt) *
stringtt* 0
>tt0 1
(tt1 2
nullablett2 :
:tt: ;
falsett< A
)ttA B
,ttB C
RoleIduu 
=uu 
tableuu "
.uu" #
Columnuu# )
<uu) *
stringuu* 0
>uu0 1
(uu1 2
nullableuu2 :
:uu: ;
falseuu< A
)uuA B
}vv 
,vv 
constraintsww 
:ww 
tableww "
=>ww# %
{xx 
tableyy 
.yy 

PrimaryKeyyy $
(yy$ %
$stryy% 9
,yy9 :
xyy; <
=>yy= ?
newyy@ C
{yyD E
xyyF G
.yyG H
UserIdyyH N
,yyN O
xyyP Q
.yyQ R
RoleIdyyR X
}yyY Z
)yyZ [
;yy[ \
tablezz 
.zz 

ForeignKeyzz $
(zz$ %
name{{ 
:{{ 
$str{{ E
,{{E F
column|| 
:|| 
x||  !
=>||" $
x||% &
.||& '
RoleId||' -
,||- .
principalTable}} &
:}}& '
$str}}( 5
,}}5 6
principalColumn~~ '
:~~' (
$str~~) -
,~~- .
onDelete  
:  !
ReferentialAction" 3
.3 4
Cascade4 ;
); <
;< =
table
ÄÄ 
.
ÄÄ 

ForeignKey
ÄÄ $
(
ÄÄ$ %
name
ÅÅ 
:
ÅÅ 
$str
ÅÅ E
,
ÅÅE F
column
ÇÇ 
:
ÇÇ 
x
ÇÇ  !
=>
ÇÇ" $
x
ÇÇ% &
.
ÇÇ& '
UserId
ÇÇ' -
,
ÇÇ- .
principalTable
ÉÉ &
:
ÉÉ& '
$str
ÉÉ( 5
,
ÉÉ5 6
principalColumn
ÑÑ '
:
ÑÑ' (
$str
ÑÑ) -
,
ÑÑ- .
onDelete
ÖÖ  
:
ÖÖ  !
ReferentialAction
ÖÖ" 3
.
ÖÖ3 4
Cascade
ÖÖ4 ;
)
ÖÖ; <
;
ÖÖ< =
}
ÜÜ 
)
ÜÜ 
;
ÜÜ 
migrationBuilder
àà 
.
àà 
CreateTable
àà (
(
àà( )
name
ââ 
:
ââ 
$str
ââ (
,
ââ( )
columns
ää 
:
ää 
table
ää 
=>
ää !
new
ää" %
{
ãã 
UserId
åå 
=
åå 
table
åå "
.
åå" #
Column
åå# )
<
åå) *
string
åå* 0
>
åå0 1
(
åå1 2
nullable
åå2 :
:
åå: ;
false
åå< A
)
ååA B
,
ååB C
LoginProvider
çç !
=
çç" #
table
çç$ )
.
çç) *
Column
çç* 0
<
çç0 1
string
çç1 7
>
çç7 8
(
çç8 9
	maxLength
çç9 B
:
ççB C
$num
ççD G
,
ççG H
nullable
ççI Q
:
ççQ R
false
ççS X
)
ççX Y
,
ççY Z
Name
éé 
=
éé 
table
éé  
.
éé  !
Column
éé! '
<
éé' (
string
éé( .
>
éé. /
(
éé/ 0
	maxLength
éé0 9
:
éé9 :
$num
éé; >
,
éé> ?
nullable
éé@ H
:
ééH I
false
ééJ O
)
ééO P
,
ééP Q
Value
èè 
=
èè 
table
èè !
.
èè! "
Column
èè" (
<
èè( )
string
èè) /
>
èè/ 0
(
èè0 1
nullable
èè1 9
:
èè9 :
true
èè; ?
)
èè? @
}
êê 
,
êê 
constraints
ëë 
:
ëë 
table
ëë "
=>
ëë# %
{
íí 
table
ìì 
.
ìì 

PrimaryKey
ìì $
(
ìì$ %
$str
ìì% :
,
ìì: ;
x
ìì< =
=>
ìì> @
new
ììA D
{
ììE F
x
ììG H
.
ììH I
UserId
ììI O
,
ììO P
x
ììQ R
.
ììR S
LoginProvider
ììS `
,
ìì` a
x
ììb c
.
ììc d
Name
ììd h
}
ììi j
)
ììj k
;
ììk l
table
îî 
.
îî 

ForeignKey
îî $
(
îî$ %
name
ïï 
:
ïï 
$str
ïï F
,
ïïF G
column
ññ 
:
ññ 
x
ññ  !
=>
ññ" $
x
ññ% &
.
ññ& '
UserId
ññ' -
,
ññ- .
principalTable
óó &
:
óó& '
$str
óó( 5
,
óó5 6
principalColumn
òò '
:
òò' (
$str
òò) -
,
òò- .
onDelete
ôô  
:
ôô  !
ReferentialAction
ôô" 3
.
ôô3 4
Cascade
ôô4 ;
)
ôô; <
;
ôô< =
}
öö 
)
öö 
;
öö 
migrationBuilder
úú 
.
úú 
CreateIndex
úú (
(
úú( )
name
ùù 
:
ùù 
$str
ùù 2
,
ùù2 3
table
ûû 
:
ûû 
$str
ûû )
,
ûû) *
column
üü 
:
üü 
$str
üü  
)
üü  !
;
üü! "
migrationBuilder
°° 
.
°° 
CreateIndex
°° (
(
°°( )
name
¢¢ 
:
¢¢ 
$str
¢¢ %
,
¢¢% &
table
££ 
:
££ 
$str
££ $
,
££$ %
column
§§ 
:
§§ 
$str
§§ (
,
§§( )
unique
•• 
:
•• 
true
•• 
,
•• 
filter
¶¶ 
:
¶¶ 
$str
¶¶ 6
)
¶¶6 7
;
¶¶7 8
migrationBuilder
®® 
.
®® 
CreateIndex
®® (
(
®®( )
name
©© 
:
©© 
$str
©© 2
,
©©2 3
table
™™ 
:
™™ 
$str
™™ )
,
™™) *
column
´´ 
:
´´ 
$str
´´  
)
´´  !
;
´´! "
migrationBuilder
≠≠ 
.
≠≠ 
CreateIndex
≠≠ (
(
≠≠( )
name
ÆÆ 
:
ÆÆ 
$str
ÆÆ 2
,
ÆÆ2 3
table
ØØ 
:
ØØ 
$str
ØØ )
,
ØØ) *
column
∞∞ 
:
∞∞ 
$str
∞∞  
)
∞∞  !
;
∞∞! "
migrationBuilder
≤≤ 
.
≤≤ 
CreateIndex
≤≤ (
(
≤≤( )
name
≥≥ 
:
≥≥ 
$str
≥≥ 1
,
≥≥1 2
table
¥¥ 
:
¥¥ 
$str
¥¥ (
,
¥¥( )
column
µµ 
:
µµ 
$str
µµ  
)
µµ  !
;
µµ! "
migrationBuilder
∑∑ 
.
∑∑ 
CreateIndex
∑∑ (
(
∑∑( )
name
∏∏ 
:
∏∏ 
$str
∏∏ "
,
∏∏" #
table
ππ 
:
ππ 
$str
ππ $
,
ππ$ %
column
∫∫ 
:
∫∫ 
$str
∫∫ )
)
∫∫) *
;
∫∫* +
migrationBuilder
ºº 
.
ºº 
CreateIndex
ºº (
(
ºº( )
name
ΩΩ 
:
ΩΩ 
$str
ΩΩ %
,
ΩΩ% &
table
ææ 
:
ææ 
$str
ææ $
,
ææ$ %
column
øø 
:
øø 
$str
øø ,
,
øø, -
unique
¿¿ 
:
¿¿ 
true
¿¿ 
,
¿¿ 
filter
¡¡ 
:
¡¡ 
$str
¡¡ :
)
¡¡: ;
;
¡¡; <
}
¬¬ 	
	protected
ƒƒ 
override
ƒƒ 
void
ƒƒ 
Down
ƒƒ  $
(
ƒƒ$ %
MigrationBuilder
ƒƒ% 5
migrationBuilder
ƒƒ6 F
)
ƒƒF G
{
≈≈ 	
migrationBuilder
∆∆ 
.
∆∆ 
	DropTable
∆∆ &
(
∆∆& '
name
«« 
:
«« 
$str
«« (
)
««( )
;
««) *
migrationBuilder
…… 
.
…… 
	DropTable
…… &
(
……& '
name
   
:
   
$str
   (
)
  ( )
;
  ) *
migrationBuilder
ÃÃ 
.
ÃÃ 
	DropTable
ÃÃ &
(
ÃÃ& '
name
ÕÕ 
:
ÕÕ 
$str
ÕÕ (
)
ÕÕ( )
;
ÕÕ) *
migrationBuilder
œœ 
.
œœ 
	DropTable
œœ &
(
œœ& '
name
–– 
:
–– 
$str
–– '
)
––' (
;
––( )
migrationBuilder
““ 
.
““ 
	DropTable
““ &
(
““& '
name
”” 
:
”” 
$str
”” (
)
””( )
;
””) *
migrationBuilder
’’ 
.
’’ 
	DropTable
’’ &
(
’’& '
name
÷÷ 
:
÷÷ 
$str
÷÷ #
)
÷÷# $
;
÷÷$ %
migrationBuilder
ÿÿ 
.
ÿÿ 
	DropTable
ÿÿ &
(
ÿÿ& '
name
ŸŸ 
:
ŸŸ 
$str
ŸŸ #
)
ŸŸ# $
;
ŸŸ$ %
}
⁄⁄ 	
}
€€ 
}‹‹ á 
oC:\Users\d.daniel.de.sousa\source\repos\RedatorSaude\RedatorSaude\Data\Migrations\20220411221055_newDocument.cs
	namespace 	
RedatorSaude
 
. 
Data 
. 

Migrations &
{ 
public 

partial 
class 
newDocument $
:% &
	Migration' 0
{ 
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{ 	
migrationBuilder		 
.		 
CreateTable		 (
(		( )
name

 
:

 
$str

  
,

  !
columns 
: 
table 
=> !
new" %
{ 
id 
= 
table 
. 
Column %
<% &
int& )
>) *
(* +
nullable+ 3
:3 4
false5 :
): ;
. 

Annotation #
(# $
$str$ 8
,8 9
$str: @
)@ A
,A B
Vara 
= 
table  
.  !
Column! '
<' (
string( .
>. /
(/ 0
nullable0 8
:8 9
true: >
)> ?
,? @
Foro 
= 
table  
.  !
Column! '
<' (
string( .
>. /
(/ 0
nullable0 8
:8 9
true: >
)> ?
,? @
Cidade 
= 
table "
." #
Column# )
<) *
string* 0
>0 1
(1 2
nullable2 :
:: ;
true< @
)@ A
,A B
Estado 
= 
table "
." #
Column# )
<) *
string* 0
>0 1
(1 2
nullable2 :
:: ;
true< @
)@ A
,A B
NumeroProcesso "
=# $
table% *
.* +
Column+ 1
<1 2
string2 8
>8 9
(9 :
nullable: B
:B C
trueD H
)H I
,I J
Autor 
= 
table !
.! "
Column" (
<( )
string) /
>/ 0
(0 1
nullable1 9
:9 :
true; ?
)? @
,@ A
Reu 
= 
table 
.  
Column  &
<& '
string' -
>- .
(. /
nullable/ 7
:7 8
true9 =
)= >
,> ?
DataCriacao 
=  !
table" '
.' (
Column( .
<. /
string/ 5
>5 6
(6 7
nullable7 ?
:? @
trueA E
)E F
,F G
NomePeca 
= 
table $
.$ %
Column% +
<+ ,
string, 2
>2 3
(3 4
nullable4 <
:< =
true> B
)B C
} 
, 
constraints 
: 
table "
=># %
{ 
table 
. 

PrimaryKey $
($ %
$str% 2
,2 3
x4 5
=>6 8
x9 :
.: ;
id; =
)= >
;> ?
} 
) 
; 
} 	
	protected 
override 
void 
Down  $
($ %
MigrationBuilder% 5
migrationBuilder6 F
)F G
{   	
migrationBuilder!! 
.!! 
	DropTable!! &
(!!& '
name"" 
:"" 
$str""  
)""  !
;""! "
}## 	
}$$ 
}%% ‡l
ZC:\Users\d.daniel.de.sousa\source\repos\RedatorSaude\RedatorSaude\Engine\RedatorOpenXml.cs
	namespace		 	
RedatorSaude		
 
.		 
Engine		 
{

 
public 

class 
RedatorOpenXml 
{ 
public 
static 
void 
MergeDocOpenXml *
(* +
string+ 1
mainFile2 :
,: ;
List< @
<@ A
stringA G
>G H
sourceFilesI T
,T U
stringV \
destMergedFile] k
)k l
{ 	
File 
. 
Delete 
( 
destMergedFile &
)& '
;' (
File 
. 
Copy 
( 
mainFile 
, 
destMergedFile  .
). /
;/ 0
int 
id 
= 
$num 
; 
foreach 
( 
string 

sourceFile &
in' )
sourceFiles* 5
)5 6
{ 
using 
( "
WordprocessingDocument -
myDoc. 3
=4 5"
WordprocessingDocument *
.* +
Open+ /
(/ 0
destMergedFile0 >
,> ?
true@ D
)D E
)E F
{ 
string 

altChunkId %
=& '
$str( 4
+5 6
id7 9
;9 :
MainDocumentPart $
mainPart% -
=. /
myDoc0 5
.5 6
MainDocumentPart6 F
;F G'
AlternativeFormatImportPart /
chunk0 5
=6 7
mainPart    
.    !*
AddAlternativeFormatImportPart  ! ?
(  ? @+
AlternativeFormatImportPartType!! 7
.!!7 8
WordprocessingML!!8 H
,!!H I

altChunkId!!J T
)!!T U
;!!U V
using"" 
("" 

FileStream"" %

fileStream""& 0
=""1 2
File""3 7
.""7 8
Open""8 <
(""< =

sourceFile""= G
,""G H
FileMode""I Q
.""Q R
Open""R V
)""V W
)""W X
chunk## 
.## 
FeedData## &
(##& '

fileStream##' 1
)##1 2
;##2 3
AltChunk$$ 
altChunk$$ %
=$$& '
new$$( +
AltChunk$$, 4
($$4 5
)$$5 6
;$$6 7
altChunk%% 
.%% 
Id%% 
=%%  !

altChunkId%%" ,
;%%, -
mainPart&& 
.&& 
Document&& %
.'' 
Body'' 
.(( 
InsertAfter(( $
((($ %
altChunk((% -
,((- .
mainPart((/ 7
.((7 8
Document((8 @
.((@ A
Body((A E
.)) 
Elements)) !
<))! "
	Paragraph))" +
>))+ ,
()), -
)))- .
.)). /
Last))/ 3
())3 4
)))4 5
)))5 6
;))6 7
mainPart** 
.** 
Document** %
.**% &
Save**& *
(*** +
)**+ ,
;**, -
id++ 
++++ 
;++ 
},, 
}-- 
}.. 	
public55 
static55 
void55 
fillDocOpenXml55 )
(55) *
string55* 0
fileDestDoc551 <
,55< =
string55> D
tag55E H
,55H I
string55J P

textTarget55Q [
)55[ \
{66 	
using77 
(77 "
WordprocessingDocument77 )
doc77* -
=77. /"
WordprocessingDocument88 )
.88) *
Open88* .
(88. /
fileDestDoc88/ :
,88: ;
true88< @
)88@ A
)88A B
{99 
var:: 
body:: 
=:: 
doc:: 
.:: 
MainDocumentPart:: /
.::/ 0
Document::0 8
.::8 9
Body::9 =
;::= >
var;; 
paras;; 
=;; 
body;;  
.;;  !
Elements;;! )
<;;) *
	Paragraph;;* 3
>;;3 4
(;;4 5
);;5 6
;;;6 7
foreach== 
(== 
var== 
para== !
in==" $
paras==% *
)==* +
{>> 
foreach?? 
(?? 
var??  
run??! $
in??% '
para??( ,
.??, -
Elements??- 5
<??5 6
Run??6 9
>??9 :
(??: ;
)??; <
)??< =
{@@ 
foreachAA 
(AA  !
varAA! $
textAA% )
inAA* ,
runAA- 0
.AA0 1
ElementsAA1 9
<AA9 :
TextAA: >
>AA> ?
(AA? @
)AA@ A
)AAA B
{BB 
ifCC 
(CC  
textCC  $
.CC$ %
TextCC% )
.CC) *
ContainsCC* 2
(CC2 3
tagCC3 6
)CC6 7
)CC7 8
{DD 
textEE  $
.EE$ %
TextEE% )
=EE* +
textEE, 0
.EE0 1
TextEE1 5
.EE5 6
ReplaceEE6 =
(EE= >
tagEE> A
,EEA B

textTargetEEC M
)EEM N
;EEN O
}FF 
}GG 
}HH 
}II 
}JJ 
}KK 	
publicRR 
staticRR 
voidRR 
fillDocListOpenXmlRR -
(RR- .
stringRR. 4
fileDestDocRR5 @
,RR@ A
stringRRB H
tagRRI L
,RRL M
ListRRN R
<RRR S
stringRRS Y
>RRY Z
ListTextTargetRR[ i
)RRi j
{SS 	
usingTT 
(TT "
WordprocessingDocumentTT )
docTT* -
=TT. /"
WordprocessingDocumentUU )
.UU) *
OpenUU* .
(UU. /
fileDestDocUU/ :
,UU: ;
trueUU< @
)UU@ A
)UUA B
{VV 
varWW 
bodyWW 
=WW 
docWW 
.WW 
MainDocumentPartWW /
.WW/ 0
DocumentWW0 8
.WW8 9
BodyWW9 =
;WW= >
varXX 
parasXX 
=XX 
bodyXX  
.XX  !
ElementsXX! )
<XX) *
	ParagraphXX* 3
>XX3 4
(XX4 5
)XX5 6
;XX6 7
foreachZZ 
(ZZ 
varZZ 
paraZZ !
inZZ" $
parasZZ% *
)ZZ* +
{[[ 
foreach\\ 
(\\ 
var\\  
run\\! $
in\\% '
para\\( ,
.\\, -
Elements\\- 5
<\\5 6
Run\\6 9
>\\9 :
(\\: ;
)\\; <
)\\< =
{]] 
foreach^^ 
(^^  !
var^^! $
text^^% )
in^^* ,
run^^- 0
.^^0 1
Elements^^1 9
<^^9 :
Text^^: >
>^^> ?
(^^? @
)^^@ A
)^^A B
{__ 
if`` 
(``  
text``  $
.``$ %
Text``% )
.``) *
Contains``* 2
(``2 3
tag``3 6
)``6 7
)``7 8
{aa 
intbb  #
ibb$ %
=bb& '
$numbb( )
;bb) *
foreachcc  '
(cc( )
varcc) ,

textTargetcc- 7
incc8 :
ListTextTargetcc; I
)ccI J
{dd  !
ifee$ &
(ee' (
iee( )
==ee* ,
$numee- .
)ee. /
{ff$ %
textgg( ,
.gg, -
Textgg- 1
=gg2 3
textgg4 8
.gg8 9
Textgg9 =
.gg= >
Replacegg> E
(ggE F
tagggF I
,ggI J

textTargetggK U
)ggU V
;ggV W
runhh( +
.hh+ ,
AppendChildhh, 7
(hh7 8
newhh8 ;
Breakhh< A
(hhA B
)hhB C
)hhC D
;hhD E
runii( +
.ii+ ,
AppendChildii, 7
(ii7 8
newii8 ;
Breakii< A
(iiA B
)iiB C
)iiC D
;iiD E
ijj( )
++jj) +
;jj+ ,
}kk$ %
elsell$ (
{mm$ %
runnn( +
.nn+ ,
AppendChildnn, 7
(nn7 8
newnn8 ;
Textnn< @
(nn@ A

textTargetnnA K
)nnK L
)nnL M
;nnM N
runoo( +
.oo+ ,
AppendChildoo, 7
(oo7 8
newoo8 ;
Breakoo< A
(ooA B
)ooB C
)ooC D
;ooD E
runpp( +
.pp+ ,
AppendChildpp, 7
(pp7 8
newpp8 ;
Breakpp< A
(ppA B
)ppB C
)ppC D
;ppD E
iqq( )
++qq) +
;qq+ ,
}rr$ %
}tt  !
}vv 
}ww 
}xx 
}yy 
}zz 
}{{ 	
public
ÇÇ 
static
ÇÇ 
void
ÇÇ 
fillDocOpenXml2
ÇÇ *
(
ÇÇ* +
string
ÇÇ+ 1
fileDestDoc
ÇÇ2 =
,
ÇÇ= >
string
ÇÇ? E
tag
ÇÇF I
,
ÇÇI J
string
ÇÇK Q

textTarget
ÇÇR \
)
ÇÇ\ ]
{
ÉÉ 	
using
ÑÑ 
(
ÑÑ $
WordprocessingDocument
ÑÑ )
doc
ÑÑ* -
=
ÑÑ. /$
WordprocessingDocument
ÑÑ0 F
.
ÑÑF G
Open
ÑÑG K
(
ÑÑK L
fileDestDoc
ÑÑL W
,
ÑÑW X
true
ÑÑY ]
)
ÑÑ] ^
)
ÑÑ^ _
{
ÖÖ 
var
áá 
document
áá 
=
áá 
doc
áá "
.
áá" #
MainDocumentPart
áá# 3
.
áá3 4
Document
áá4 <
;
áá< =
foreach
ââ 
(
ââ 
var
ââ 
text
ââ !
in
ââ" $
document
ââ% -
.
ââ- .
Descendants
ââ. 9
<
ââ9 :
Text
ââ: >
>
ââ> ?
(
ââ? @
)
ââ@ A
)
ââA B
{
ää 
if
ãã 
(
ãã 
text
ãã 
.
ãã 
Text
ãã !
.
ãã! "
Contains
ãã" *
(
ãã* +
tag
ãã+ .
)
ãã. /
)
ãã/ 0
{
åå 
text
çç 
.
çç 
Text
çç !
=
çç" #
text
çç$ (
.
çç( )
Text
çç) -
.
çç- .
Replace
çç. 5
(
çç5 6
tag
çç6 9
,
çç9 :

textTarget
çç; E
)
ççE F
;
ççF G
}
éé 
}
èè 
}
êê 
}
ëë 	
public
ôô 
static
ôô 
void
ôô 
searchAndReplace
ôô +
(
ôô+ ,
string
ôô, 2
dest1
ôô3 8
,
ôô8 9
string
ôô: @
temp
ôôA E
,
ôôE F
string
ôôG M
tag
ôôN Q
,
ôôQ R
string
ôôS Y
textToReplace
ôôZ g
)
ôôg h
{
öö 	
File
õõ 
.
õõ 
Delete
õõ 
(
õõ 
temp
õõ 
)
õõ 
;
õõ 
File
úú 
.
úú 
Copy
úú 
(
úú 
dest1
úú 
,
úú 
temp
úú !
)
úú! "
;
úú" #
using
ûû 
(
ûû $
WordprocessingDocument
ûû )
wordDoc
ûû* 1
=
ûû2 3$
WordprocessingDocument
üü "
.
üü" #
Open
üü# '
(
üü' (
temp
üü( ,
,
üü, -
true
üü. 2
)
üü2 3
)
üü3 4
{
†† 
string
¢¢ 
docText
¢¢ 
=
¢¢  
null
¢¢! %
;
¢¢% &
using
££ 
(
££ 
StreamReader
££ #
sr
££$ &
=
££' (
new
££) ,
StreamReader
££- 9
(
££9 :
wordDoc
££: A
.
££A B
MainDocumentPart
££B R
.
££R S
	GetStream
££S \
(
££\ ]
)
££] ^
)
££^ _
)
££_ `
{
§§ 
docText
•• 
=
•• 
sr
••  
.
••  !
	ReadToEnd
••! *
(
••* +
)
••+ ,
;
••, -
}
¶¶ 
if
®® 
(
®® 
docText
®® 
.
®® 
Contains
®® $
(
®®$ %
tag
®®% (
)
®®( )
)
®®) *
{
©© 
docText
™™ 
=
™™ 
docText
™™ %
.
™™% &
Replace
™™& -
(
™™- .
tag
™™. 1
,
™™1 2
textToReplace
™™3 @
)
™™@ A
;
™™A B
docText
´´ 
=
´´ 
docText
´´ %
.
´´% &
Replace
´´& -
(
´´- .
$str
´´. 1
,
´´1 2
$str
´´3 5
)
´´5 6
;
´´6 7
docText
¨¨ 
=
¨¨ 
docText
¨¨ %
.
¨¨% &
Replace
¨¨& -
(
¨¨- .
$str
¨¨. 1
,
¨¨1 2
$str
¨¨3 5
)
¨¨5 6
;
¨¨6 7
}
≠≠ 
using
ØØ 
(
ØØ 
StreamWriter
ØØ #
sw
ØØ$ &
=
ØØ' (
new
ØØ) ,
StreamWriter
ØØ- 9
(
ØØ9 :
wordDoc
ØØ: A
.
ØØA B
MainDocumentPart
ØØB R
.
ØØR S
	GetStream
ØØS \
(
ØØ\ ]
FileMode
ØØ] e
.
ØØe f
Create
ØØf l
)
ØØl m
)
ØØm n
)
ØØn o
{
∞∞ 
sw
±± 
.
±± 
Write
±± 
(
±± 
docText
±± $
)
±±$ %
;
±±% &
}
≤≤ 
}
≥≥ 
}
¥¥ 	
}
µµ 
}∂∂ °
TC:\Users\d.daniel.de.sousa\source\repos\RedatorSaude\RedatorSaude\Models\Document.cs
	namespace 	
RedatorSaude
 
. 
Models 
{ 
public 

class 
Document 
{		 
public 
int 
id 
{ 
get 
; 
set  
;  !
}" #
public 
string 
Vara 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
Foro 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
Cidade 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
Estado 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
NumeroProcesso $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
string 
Autor 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
Reu 
{ 
get 
;  
set! $
;$ %
}& '
public 
string 
DataCriacao !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
NomePeca 
{  
get! $
;$ %
set& )
;) *
}+ ,
} 
} ®
ZC:\Users\d.daniel.de.sousa\source\repos\RedatorSaude\RedatorSaude\Models\ErrorViewModel.cs
	namespace 	
RedatorSaude
 
. 
Models 
{ 
public 

class 
ErrorViewModel 
{ 
public 
string 
	RequestId 
{  !
get" %
;% &
set' *
;* +
}, -
public		 
bool		 
ShowRequestId		 !
=>		" $
!		% &
string		& ,
.		, -
IsNullOrEmpty		- :
(		: ;
	RequestId		; D
)		D E
;		E F
}

 
} ¢
OC:\Users\d.daniel.de.sousa\source\repos\RedatorSaude\RedatorSaude\Models\Map.cs
	namespace 	
RedatorSaude
 
. 
Models 
{ 
public 

class 
Map 
{ 
public 
static 
string 
rootFilepath )
=* +
$str, @
;@ A
public 
static 
string 
document_resutaldo /
=0 1
rootFilepath2 >
+? @
$strB M
;M N
public 
static 
string )
document_pagamento_condenacao :
=; <
rootFilepath= I
+J K
$strM h
;h i
public 
static 
string +
document_especificao_sem_provas <
== >
rootFilepath? K
+L M
$strN m
;m n
public 
static 
string *
document_juntada_custas_finais ;
=< =
rootFilepath> J
+K L
$strM i
;i j
public 
static 
string (
document_juntada_cartas_subs 9
=: ;
rootFilepath< H
+I J
$strK e
;e f
public 
static 
string 8
,document_especificacao_provas_pericia_medica I
=J K
rootFilepathL X
+Y Z
$str	[ Ç
;
Ç É
} 
} á9
`C:\Users\d.daniel.de.sousa\source\repos\RedatorSaude\RedatorSaude\Models\SimpleDocumentHelper.cs
	namespace 	
RedatorSaude
 
. 
Models 
{ 
public 

class  
SimpleDocumentHelper %
{		 
public

 
static

 
string

 
GetFilePathByType

 .
(

. /
string

/ 5
tipo

6 :
)

: ;
{ 	
switch 
( 
tipo 
) 
{ 
case 
$str  
:  !
return 
Map 
. 
document_resutaldo 1
;1 2
case 
$str +
:+ ,
return 
Map 
. )
document_pagamento_condenacao <
;< =
case 
$str -
:- .
return 
Map 
. +
document_especificao_sem_provas >
;> ?
case 
$str ,
:, -
return 
Map 
. *
document_juntada_custas_finais =
;= >
case 
$str *
:* +
return 
Map 
. (
document_juntada_cartas_subs ;
;; <
case 
$str +
:+ ,
return 
Map 
. 8
,document_especificacao_provas_pericia_medica K
;K L
} 
return 
$str 
; 
} 	
public 
static 
string 
GetQuali %
(% &
string& ,
tipo- 1
)1 2
{ 	
switch   
(   
tipo   
)   
{!! 
case"" 
$str"" A
:""A B
return## 
$str	## Œ
;
##Œ œ
case$$ 
$str$$ (
:$$( )
return%% 
$str	%% ﬁ
;
%%ﬁ ﬂ
case&& 
$str&& :
:&&: ;
return'' 
$str	'' Ÿ
;
''Ÿ ⁄
case(( 
$str(( .
:((. /
return)) 
$str	)) ∆
;
))∆ «
case** 
$str** 5
:**5 6
return++ 
$str	++  
;
++  À
case,, 
$str,, ?
:,,? @
return-- 
$str	-- ¸
;
--¸ ˝
case.. 
$str.. ;
:..; <
return// 
$str	// ‘
;
//‘ ’
case00 
$str00 1
:001 2
return11 
$str	11 ∂
;
11∂ ∑
case22 
$str22 5
:225 6
return33 
$str	33 ﬂ
;
33ﬂ ‡
case44 
$str44 7
:447 8
return55 
$str	55 ®
;
55® ©
case66 
$str66 W
:66W X
return77 
$str	77 ˝
;
77˝ ˛
}88 
return99 
$str99 
;99 
}:: 	
public<< 
static<< 
string<< 
GetTypeString<< *
(<<* +
string<<+ 1
tipo<<2 6
)<<6 7
{== 	
switch>> 
(>> 
tipo>> 
)>> 
{?? 
case@@ 
$str@@  
:@@  !
returnAA 
$strAA &
;AA& '
caseBB 
$strBB +
:BB+ ,
returnCC 
$strCC 1
;CC1 2
caseDD 
$strDD -
:DD- .
returnEE 
$strEE 3
;EE3 4
caseFF 
$strFF ,
:FF, -
returnGG 
$strGG 2
;GG2 3
caseHH 
$strHH *
:HH* +
returnII 
$strII 0
;II0 1
caseJJ 
$strJJ +
:JJ+ ,
returnKK 
$strKK 1
;KK1 2
}LL 
returnMM 
$strMM 
;MM 
}NN 	
publicPP 
staticPP 
stringPP 
GetUFPP "
(PP" #
stringPP# )
estadoPP* 0
)PP0 1
{QQ 	
switchRR 
(RR 
estadoRR 
)RR 
{SS 
caseTT 
$strTT !
:TT! "
returnUU 
$strUU 
;UU  
caseVV 
$strVV 
:VV 
returnWW 
$strWW 
;WW  
caseXX 
$strXX 
:XX 
returnYY 
$strYY 
;YY  
caseZZ 
$strZZ 
:ZZ 
return[[ 
$str[[ 
;[[  
case\\ 
$str\\ 
:\\ 
return]] 
$str]] 
;]]  
case^^ 
$str^^ 
:^^  
return__ 
$str__ 
;__  
case`` 
$str`` 
:`` 
returnaa 
$straa 
;aa  
casebb 
$strbb "
:bb" #
returncc 
$strcc 
;cc  
casedd 
$strdd )
:dd) *
returnee 
$stree 
;ee  
caseff 
$strff (
:ff( )
returngg 
$strgg 
;gg  
casehh 
$strhh *
:hh* +
returnii 
$strii 
;ii  
casejj 
$strjj 
:jj 
returnkk 
$strkk 
;kk  
casell 
$strll %
:ll% &
returnmm 
$strmm 
;mm  
casenn 
$strnn 
:nn 
returnoo 
$stroo 
;oo  
casepp 
$strpp  
:pp  !
returnqq 
$strqq 
;qq  
caserr 
$strrr %
:rr% &
returnss 
$strss 
;ss  
casett 
$strtt %
:tt% &
returnuu 
$struu 
;uu  
casevv 
$strvv #
:vv# $
returnww 
$strww 
;ww  
casexx 
$strxx 
:xx 
returnyy 
$stryy 
;yy  
casezz 
$strzz 
:zz 
return{{ 
$str{{ 
;{{  
case|| 
$str|| '
:||' (
return}} 
$str}} 
;}}  
case~~ 
$str~~ 
:~~ 
return 
$str 
;  
case
ÄÄ 
$str
ÄÄ 
:
ÄÄ  
return
ÅÅ 
$str
ÅÅ 
;
ÅÅ  
case
ÇÇ 
$str
ÇÇ 
:
ÇÇ 
return
ÉÉ 
$str
ÉÉ 
;
ÉÉ  
case
ÑÑ 
$str
ÑÑ 
:
ÑÑ  
return
ÖÖ 
$str
ÖÖ 
;
ÖÖ  
case
ÜÜ 
$str
ÜÜ  
:
ÜÜ  !
return
áá 
$str
áá 
;
áá  
case
àà 
$str
àà 
:
àà 
return
ââ 
$str
ââ 
;
ââ  
}
ää 
return
ãã 
$str
ãã 
;
ãã 
}
åå 	
}
çç 
}éé ¶

LC:\Users\d.daniel.de.sousa\source\repos\RedatorSaude\RedatorSaude\Program.cs
	namespace

 	
RedatorSaude


 
{ 
public 

class 
Program 
{ 
public 
static 
void 
Main 
(  
string  &
[& '
]' (
args) -
)- .
{ 	
CreateHostBuilder 
( 
args "
)" #
.# $
Build$ )
() *
)* +
.+ ,
Run, /
(/ 0
)0 1
;1 2
} 	
public 
static 
IHostBuilder "
CreateHostBuilder# 4
(4 5
string5 ;
[; <
]< =
args> B
)B C
=>D F
Host 
.  
CreateDefaultBuilder %
(% &
args& *
)* +
. $
ConfigureWebHostDefaults )
() *

webBuilder* 4
=>5 7
{ 

webBuilder 
. 

UseStartup )
<) *
Startup* 1
>1 2
(2 3
)3 4
;4 5
} 
) 
; 
} 
} Á+
\C:\Users\d.daniel.de.sousa\source\repos\RedatorSaude\RedatorSaude\Service\DocumentService.cs
	namespace 	
RedatorSaude
 
. 
Service 
{ 
public		 

class		 
DocumentService		  
{

 
public 
static 
Stream 
CreateSimpleDoc ,
(, -
Document- 5
doc6 9
)9 :
{ 	
Stream 
stream 
; 
using 
( 
MemoryStream 
mem  #
=$ %
new& )
MemoryStream* 6
(6 7
)7 8
)8 9
{ 
using 
( "
WordprocessingDocument -
wordDoc. 5
=6 7"
WordprocessingDocument8 N
.N O
CreateO U
(U V
memV Y
,Y Z
DocumentFormat[ i
.i j
OpenXmlj q
.q r'
WordprocessingDocumentType	r å
.
å ç
Document
ç ï
,
ï ñ
true
ó õ
)
õ ú
)
ú ù
{ 
string 
	_mainFile $
=% & 
SimpleDocumentHelper' ;
.; <
GetFilePathByType< M
(M N
docN Q
.Q R
NomePecaR Z
)Z [
;[ \
string 
	_destFile $
=% & 
SimpleDocumentHelper' ;
.; <
GetFilePathByType< M
(M N
$strN Y
)Y Z
;Z [
RedatorOpenXml "
." #
searchAndReplace# 3
(3 4
	_mainFile4 =
,= >
	_destFile? H
,H I
$strJ R
,R S
docT W
.W X
VaraX \
.\ ]
ToUpper] d
(d e
)e f
)f g
;g h
RedatorOpenXml "
." #
fillDocOpenXml# 1
(1 2
	_destFile2 ;
,; <
$str= E
,E F
docG J
.J K
ForoK O
.O P
ToUpperP W
(W X
)X Y
)Y Z
;Z [
RedatorOpenXml "
." #
fillDocOpenXml# 1
(1 2
	_destFile2 ;
,; <
$str= F
,F G 
SimpleDocumentHelperH \
.\ ]
GetQuali] e
(e f
docf i
.i j
Reuj m
)m n
.n o
ToUppero v
(v w
)w x
)x y
;y z
RedatorOpenXml "
." #
fillDocOpenXml# 1
(1 2
	_destFile2 ;
,; <
$str= G
,G H
docI L
.L M
CidadeM S
.S T
ToUpperT [
([ \
)\ ]
)] ^
;^ _
RedatorOpenXml "
." #
fillDocOpenXml# 1
(1 2
	_destFile2 ;
,; <
$str= G
,G H
docI L
.L M
EstadoM S
.S T
ToUpperT [
([ \
)\ ]
)] ^
;^ _
RedatorOpenXml "
." #
fillDocOpenXml# 1
(1 2
	_destFile2 ;
,; <
$str= O
,O P
docQ T
.T U
NumeroProcessoU c
.c d
ToUpperd k
(k l
)l m
)m n
;n o
RedatorOpenXml "
." #
fillDocOpenXml# 1
(1 2
	_destFile2 ;
,; <
$str= D
,D E
docF I
.I J
ReuJ M
.M N
ToUpperN U
(U V
)V W
)W X
;X Y
RedatorOpenXml "
." #
fillDocOpenXml# 1
(1 2
	_destFile2 ;
,; <
$str= F
,F G
docH K
.K L
AutorL Q
.Q R
ToUpperR Y
(Y Z
)Z [
)[ \
;\ ]
RedatorOpenXml "
." #
fillDocOpenXml# 1
(1 2
	_destFile2 ;
,; <
$str= C
,C D 
SimpleDocumentHelperE Y
.Y Z
GetUFZ _
(_ `
doc` c
.c d
Estadod j
.j k
ToUpperk r
(r s
)s t
)t u
)u v
;v w
RedatorOpenXml "
." #
fillDocOpenXml# 1
(1 2
	_destFile2 ;
,; <
$str= L
,L M
DateTimeN V
.V W
NowW Z
.Z [
ToString[ c
(c d
$strd r
)r s
.s t
Replacet {
({ |
$str| 
,	 Ä
$str
Å á
)
á à
.
à â
ToUpper
â ê
(
ê ë
)
ë í
)
í ì
;
ì î
stream   
=   
new    

FileStream  ! +
(  + ,
	_destFile  , 5
,  5 6
FileMode  7 ?
.  ? @
Open  @ D
,  D E

FileAccess  F P
.  P Q
	ReadWrite  Q Z
,  Z [
	FileShare  \ e
.  e f
	ReadWrite  f o
)  o p
;  p q
}!! 
return"" 
stream"" 
;"" 
}## 
}$$ 	
}%% 
}&& ∫
LC:\Users\d.daniel.de.sousa\source\repos\RedatorSaude\RedatorSaude\Startup.cs
	namespace 	
RedatorSaude
 
{ 
public 

class 
Startup 
{ 
public 
Startup 
( 
IConfiguration %
configuration& 3
)3 4
{ 	
Configuration 
= 
configuration )
;) *
} 	
public 
IConfiguration 
Configuration +
{, -
get. 1
;1 2
}3 4
public 
void 
ConfigureServices %
(% &
IServiceCollection& 8
services9 A
)A B
{ 	
services 
. 
AddDbContext !
<! " 
ApplicationDbContext" 6
>6 7
(7 8
options8 ?
=>@ B
options 
. 
UseSqlServer $
($ %
Configuration   !
.  ! "
GetConnectionString  " 5
(  5 6
$str  6 I
)  I J
)  J K
)  K L
;  L M
services!! 
.!! 
AddDefaultIdentity!! '
<!!' (
IdentityUser!!( 4
>!!4 5
(!!5 6
options!!6 =
=>!!> @
options!!A H
.!!H I
SignIn!!I O
.!!O P#
RequireConfirmedAccount!!P g
=!!h i
true!!j n
)!!n o
."" $
AddEntityFrameworkStores"" )
<"") * 
ApplicationDbContext""* >
>""> ?
(""? @
)""@ A
;""A B
services## 
.## #
AddControllersWithViews## ,
(##, -
)##- .
;##. /
services$$ 
.$$ 
AddRazorPages$$ "
($$" #
)$$# $
;$$$ %
}%% 	
public(( 
void(( 
	Configure(( 
((( 
IApplicationBuilder(( 1
app((2 5
,((5 6
IWebHostEnvironment((7 J
env((K N
)((N O
{)) 	
if** 
(** 
env** 
.** 
IsDevelopment** !
(**! "
)**" #
)**# $
{++ 
app,, 
.,, %
UseDeveloperExceptionPage,, -
(,,- .
),,. /
;,,/ 0
app-- 
.--  
UseDatabaseErrorPage-- (
(--( )
)--) *
;--* +
}.. 
else// 
{00 
app11 
.11 
UseExceptionHandler11 '
(11' (
$str11( 5
)115 6
;116 7
app33 
.33 
UseHsts33 
(33 
)33 
;33 
}44 
app55 
.55 
UseHttpsRedirection55 #
(55# $
)55$ %
;55% &
app66 
.66 
UseStaticFiles66 
(66 
)66  
;66  !
app88 
.88 

UseRouting88 
(88 
)88 
;88 
app:: 
.:: 
UseAuthentication:: !
(::! "
)::" #
;::# $
app;; 
.;; 
UseAuthorization;;  
(;;  !
);;! "
;;;" #
app== 
.== 
UseEndpoints== 
(== 
	endpoints== &
=>==' )
{>> 
	endpoints?? 
.?? 
MapControllerRoute?? ,
(??, -
name@@ 
:@@ 
$str@@ #
,@@# $
patternAA 
:AA 
$strAA E
)AAE F
;AAF G
	endpointsBB 
.BB 
MapRazorPagesBB '
(BB' (
)BB( )
;BB) *
}CC 
)CC 
;CC 
}DD 	
}EE 
}FF 